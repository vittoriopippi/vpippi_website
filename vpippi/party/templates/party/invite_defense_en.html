{% extends "party/base.html" %}
{% load static %}

{% block title %}Invitation {{ invite.name }} – PhD Defence{% endblock %}

{% block content %}
<div class="content">
  <div class="container oktober_container p-3">
    <div class="vitto-toast d-none">
      <div class="vitto-toast-body">
        Thanks for your response!
      </div>
    </div>

    <!-- TOP SVG -->
    {% include "party/top_noholes.svg" %}
    <div class="oktober px-4 pt-0 pb-1">

        <!-- Custom title -->
        {% comment %} <div class="sanremo_title pb-3"><h1><span style="color: #6e07f3;">DOC</span><stem style="color: #F81A97ff;">TORVITTO</stem> <div class="year"><span>20</span><span>25</span></div></h1></div> {% endcomment %}
        
        {% if invite.name %}
          <h1 class="card-title circus pb-3">{{ invite.name | upper }}</h1>
        {% endif %}

        <p class="card-text">
          It has been a long journey full of ups and downs, and now we've reached the final event: my <strong>PhD defence</strong>! 🎓✨
        </p>
        <p class="card-text">
          On <strong>Monday, 30&nbsp;June&nbsp;2025</strong> I will defend my thesis in the <a href="https://maps.app.goo.gl/2kiup5Zx7MxeujWb9" target="_blank">Aula&nbsp;Magna of the “Francesco&nbsp;Severi” National Institute of Higher Mathematics, Rome</a>.  
          The defence will start at <strong>14:00</strong> and the graduation ceremony is scheduled for <strong>18:00</strong>.  
          If you'd like to come and keep me company, I'd be delighted to see you! 🥳💜
        </p>

        <!-- COLLAPSIBLE – Full schedule -->
        <button class="btn btn-outline-secondary mb-3" style="width: 100%;" type="button" data-bs-toggle="collapse" data-bs-target="#defenceSchedule" aria-expanded="false" aria-controls="defenceSchedule">
          📅 Day schedule
        </button>
        <div class="collapse" id="defenceSchedule">
          <div class="card card-body text-bg-dark">
            <p class="card-text mb-2"><strong>Full schedule</strong></p>
            <ul class="mb-3">
              <li>14:00 – 15:00 — <strong>Costanza&nbsp;Alfieri</strong>: <em>Ethics and Privacy in the Age of AI: Challenges and Solutions for Human Empowerment</em></li>
              <li>15:00 – 16:00 — <strong>Daniele&nbsp;Lotito</strong>: <em>Associative Networks Beyond Pattern Retrieval</em></li>
              <li>16:00 – 17:00 — <strong>Vittorio&nbsp;Pippi</strong>: <em>Handwritten Text Generation for Recognition: From Visual Archetypes to Autoregressive Models</em></li>
              <li>17:45 – 18:15 — 🎓 <strong>Graduation ceremony</strong></li>
            </ul>
          </div>
        </div>

        <!-- COLLAPSIBLE – Trip details -->
        <button class="btn btn-outline-secondary mb-3" style="width: 100%;" type="button" data-bs-toggle="collapse" data-bs-target="#romaTrip" aria-expanded="false" aria-controls="romaTrip">
          🚄 Info for coming to Rome
        </button>
        <div class="collapse" id="romaTrip">
          <div class="card card-body text-bg-dark">
            <p class="card-text mb-2"><strong>My train tickets</strong> 🎫</p>
            <ul class="mb-3">
              <li>Outbound: <em>Modena</em> 07:42 → <em>Roma&nbsp;Termini</em> 10:35 – Frecciarossa&nbsp;1000&nbsp;9303, carriage&nbsp;5, seat&nbsp;17D.</li>
              <li>Return: <em>Roma&nbsp;Termini</em> 19:50 → <em>Modena</em> 22:44 – Frecciarossa&nbsp;1000&nbsp;9330, carriage&nbsp;7, seat&nbsp;6D.</li>
            </ul>
            <p class="card-text">
              I also looked into renting a <strong>9‑seater minivan</strong> (driver + 8 passengers) for the whole day at a total cost of about <strong>€320</strong> + <strong>€60</strong> tolls round‑trip, i.e. ~<strong>€45 per person</strong> there and back. 🚐💨<br/>
              <em>The quote refers to the <strong>Modena ↔ Rome</strong> route; if you're coming from <strong>Foligno</strong> the journey is even shorter!</em><br/>
              If you're interested, let me know and I'll pass you the agency's contact!
            </p>
          </div>
        </div>

        <!-- Celebration aperitif paragraph -->
        <p class="card-text mt-2">
          I'm also organising a <strong>celebration aperitif</strong> on the evening of <strong>Tuesday, 1&nbsp;July</strong> in <strong><u>Modena</u></strong>, <strong>at 19:00 at <a href="https://maps.app.goo.gl/VndALjXubkkmwPqF9" target="_blank">Freedom</a></strong>. 🥂  
          I'd love to treat everyone, so please let me know as soon as you can by choosing an option below!
        </p>

        <!-- Hospitality paragraph -->
        <p class="card-text mt-2">
          If you're coming from out of town and plan to stay in <strong><u>Modena</u></strong> for the aperitif on <strong>1&nbsp;July</strong>, I can host you for the night – just let me know so I can arrange! 🛏️
        </p>
    </div>

    {% if not fake %}
    <!-- MIDDLE SVG -->
    {% include "party/mid_smholes.svg" %}
    <div class="oktober px-4 ticket_bottom">
      <div class="left mt-4">
        <div class="sanremo_title pb-3"><h1>D<stem style="color: #F81A97ff;">V</stem> <div class="year"><span>20</span><span>25</span></div></h1></div>
      </div>
      <div class="ticket_form">
          <h3 class="mb-2">Aperitif 1&nbsp;July: will you be there?</h3>
          <div class="checkbox {% if invite.state == "YE" %}active{% endif %}">
            <div class="box">
              <svg class="single-tick" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32px" height="32px"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"/></svg>
            </div>
            <div class="text" data-value="YE">I'LL BE THERE!</div></div>
          <div class="checkbox {% if invite.state == "NO" %}active{% endif %}"><div class="box">
            <svg class="cross" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.13 20.13"><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><rect x="-3.16" y="9.06" width="26.45" height="2.01" transform="translate(-4.17 10.06) rotate(-45)"/><rect x="-3.16" y="9.06" width="26.45" height="2.01" transform="translate(10.06 -4.17) rotate(45)"/></g></g></svg>
          </div><div class="text" data-value="NO">CAN'T MAKE IT</div></div>
          <div class="checkbox {% if invite.state == "+1" %}active{% endif %}"><div class="box">
            <svg class="double-tick" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35.81 20.13"><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><path d="M26,0,8.72,17.28,1.44,10,0,11.44l8,8,.72.69.72-.69,18-18Z"/><path d="M34.37,0,17.09,17.28,9.81,10,8.37,11.44l8,8,.72.69.72-.69,18-18Z"/></g></g></svg>
          </div><div class="text" data-value="+1">WE'LL BE THERE! +1</div></div>
      </div>
    </div>
    {% endif %}
    <!-- BOTTOM SVG -->
    {% include "party/bottom_noholes.svg" %}
  </div>
</div>
{% endblock %}

{% block script %}
<script>
  function set_partecipation(partecipation) {
    console.log(partecipation);
    $.post(window.location, {attending: partecipation});
  }

  function show_toast(msg) {
    $('.vitto-toast').removeClass('d-none');
    $('.vitto-toast').addClass('show');
  
    setTimeout(function() {
      $('.vitto-toast').removeClass('show');
    }, 2000);
  }

  $(document).ready(function() {
    $('.checkbox').click(function() {
      if ($(this).hasClass('active')) {
        set_partecipation('PD');
      } else {
        show_toast('Saved!');
        set_partecipation($(this).find('.text').data('value'));
        $('.checkbox').removeClass('active');
      }
      $(this).toggleClass('active');
    });
  });
</script>
{% endblock %}
