{% extends "party/base.html" %}
{% load static %}

{% block title %}Invito {{ invite.name }} - Difesa di Dottorato{% endblock %}

{% block content %}
<div class="content">
  <div class="container oktober_container p-3">
    <div class="vitto-toast d-none">
      <div class="vitto-toast-body">
        Grazie per la risposta! 
      </div>
    </div>

    <!-- TOP SVG -->
    {% include "party/top_noholes.svg" %}
    <div class="oktober px-4 pt-0 pb-1">

        <!-- Titolo custom -->
        {% comment %} <div class="sanremo_title pb-3"><h1><span style="color: #6e07f3;">DOC</span><stem style="color: #F81A97ff;">TORVITTO</stem> <div class="year"><span>20</span><span>25</span></div></h1></div> {% endcomment %}
        
        {% if invite.name %}
          <h1 class="card-title circus pb-3">{{ invite.name | upper }}</h1>
        {% endif %}

        <p class="card-text">
          È stato un lungo percorso fatto di alti e di bassi, e ora siamo arrivati all'evento finale: la mia <strong>difesa di dottorato</strong>! 🎓✨
        </p>
        <p class="card-text">
          Il <strong>lunedì 30 giugno 2025</strong> discuterò la mia tesi presso l'<a href="https://maps.app.goo.gl/2kiup5Zx7MxeujWb9" target="_blank">Istituto Nazionale di Alta Matematica "Francesco Severi", Roma</a>.
          La discussione inizierà alle <strong>14:00</strong> e la proclamazione è prevista per le <strong>18:00</strong>.
          Se ti va di passare a farmi compagnia sarò felicissimə di vederti! 🥳💜
        </p>

        <!-- COLLAPSIBLE – Dettagli viaggio a Roma -->
        <button class="btn btn-outline-secondary mb-3" style="width: 100%;" type="button" data-bs-toggle="collapse" data-bs-target="#romaTrip" aria-expanded="false" aria-controls="romaTrip">
          🚄 Info per venire a Roma
        </button>
        <div class="collapse" id="romaTrip">
          <div class="card card-body text-bg-dark">
            <p class="card-text mb-2"><strong>I miei biglietti del treno</strong> 🎫</p>
            <ul class="mb-3">
              <li>Andata: <em>Modena</em> 07:42 → <em>Roma Termini</em> 10:35 – Frecciarossa 1000 9303, carrozza 5, posto 17D.</li>
              <li>Ritorno: <em>Roma Termini</em> 19:50 → <em>Modena</em> 22:44 – Frecciarossa 1000 9330, carrozza 7, posto 6D.</li>
            </ul>
            <p class="card-text">
              Avevo valutato anche il noleggio di un <strong>minivan 9 posti</strong> (conducente + 8 passeggeri) per l'intera giornata al costo complessivo di circa <strong>320 €</strong> + <strong>60 €</strong> di pedaggio A/R, ovvero ~<strong>45 € a persona</strong> andata e ritorno. 🚐💨
              Se sei interessat&#601; fammelo sapere e ti giro subito il contatto dell'agenzia!
            </p>
          </div>
        </div>

        <p class="card-text mt-2">
          Inoltre sto organizzando un <strong>aperitivo di festeggiamento</strong> la sera di <strong>martedì 1 luglio</strong>. 🥂
          Mi piacerebbe poter offrire qualcosa a tutti, quindi fammi sapere il prima possibile se riesci a venire selezionando l'opzione qui sotto!
        </p>
    </div>

    {% if not fake %}
    <!-- MIDDLE SVG -->
    {% include "party/mid_smholes.svg" %}
    <div class="oktober px-4 ticket_bottom">
      <div class="left mt-4">
        <div class="sanremo_title pb-3"><h1>D<stem style="color: #F81A97ff;">V</stem> <div class="year"><span>20</span><span>25</span></div></h1></div>
      </div>
      <div class="ticket_form">
          <h3 class="mb-2">Aperitivo 1 luglio: ci sarai?</h3>
          <div class="checkbox {% if invite.state == "YE" %}active{% endif %}">
            <div class="box">
              <svg class="single-tick" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 32 32" width="32px" height="32px"><path d="M 28.28125 6.28125 L 11 23.5625 L 3.71875 16.28125 L 2.28125 17.71875 L 10.28125 25.71875 L 11 26.40625 L 11.71875 25.71875 L 29.71875 7.71875 Z"/></svg>
            </div>
            <div class="text" data-value="YE">CI SARÒ!</div></div>
          <div class="checkbox {% if invite.state == "NO" %}active{% endif %}"><div class="box">
            <svg class="cross" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.13 20.13"><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><rect x="-3.16" y="9.06" width="26.45" height="2.01" transform="translate(-4.17 10.06) rotate(-45)"/><rect x="-3.16" y="9.06" width="26.45" height="2.01" transform="translate(10.06 -4.17) rotate(45)"/></g></g></svg>
          </div><div class="text" data-value="NO">NON POSSO</div></div>
          <div class="checkbox  {% if invite.state == "+1" %}active{% endif %}"><div class="box">
            <svg class="double-tick" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35.81 20.13"><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><path d="M26,0,8.72,17.28,1.44,10,0,11.44l8,8,.72.69.72-.69,18-18Z"/><path d="M34.37,0,17.09,17.28,9.81,10,8.37,11.44l8,8,.72.69.72-.69,18-18Z"/></g></g></svg>
          </div><div class="text" data-value="+1">CI SIAMO! +1</div></div>
      </div>
    </div>
    {% endif %}
    <!-- BOTTOM SVG -->
    {% include "party/bottom_noholes.svg" %}
  </div>
</div>

{% endblock %}

{% block script %}
<script>
  function set_partecipation(partecipation) {
    console.log(partecipation);
    $.post(window.location, {attending: partecipation});
  }

  function show_toast(msg) {
    $('.vitto-toast').removeClass('d-none');
    $('.vitto-toast').addClass('show');
  
    setTimeout(function() {
      $('.vitto-toast').removeClass('show');
    }, 2000);
  }

  $(document).ready(function() {
    $('.checkbox').click(function() {
      if ($(this).hasClass('active')) {
        set_partecipation('PD');
      } else {
        show_toast('Salvato!');
        set_partecipation($(this).find('.text').data('value'));
        $('.checkbox').removeClass('active');
      }
      $(this).toggleClass('active');
    });
  });
</script>
{% endblock %}
